function I   =  lm_step1(I)
[hang,cot] = size(I);
M          = uint8(zeros(hang,cot));
I          = uint8(I);
while(1)
    check = 1;
    %=============================================================================
for h=3:(hang-1)
    for c=3:(cot-1)
%--------------------------------------------------------------------------%
      P   = I(h,c);
      if (P==0) 
          continue;
      else
      P1  = I(h-1,c-1);   P2 = I(h-1,c  );   P3 = I(h-1,c+1);
      P4  = I(h  ,c+1);   P5 = I(h+1,c+1);   P6 = I(h+1,c  );
      P7  = I(h+1,c-1);   P8 = I(h  ,c-1);   P9 = I(h-2,c-2);
      P10 = I(h-2,c-1);   P11= I(h-2,c  );   P12= I(h-2,c+1);
      P13 = I(h+1,c-2);   P14= I(h  ,c-2);   P15= I(h-1,c-2);
      %--------------------------------------------------------------------%condition1
      Px1 = (~P4)&P8&((P1&P2&(~P5)&(~P6))|((~P2)&(~P3)&P6&P7));
      Px2 = P6&P7&P8&((P1&P2&(~P4))|((~P2)&P4&P5));
      Px3 = (~P2)&(~P3)&(~P4)&((((~P5)&(~P6)&P8)&(P1|P7))|(((~P1)&P6&(~P8))&(P7|P5)));
      Px4 = P4&(~P8)&(((~P1)&(~P2)&P6)|(P2&(~P6)&(~P7)));
      Px5 = P2&P3&P4&((P5&P6&(~P8))|(P1&(~P6)&P8));
      Px6 = (~P6)&(~P7)&(~P8)&((((~P1)&(~P2)&P4)&(P5|P3))|((P2&(~P4)&(~P5))&(P3|P1)));
    
      Px  = Px1|Px2|Px3|Px4|Px5|Px6;
      %--------------------------------------------------------------------%condition2
      Py1 = P1&P2&P6&P7&P8&(~P4)&(~P14);
      Py2 = P1&P2&P3&P4&(~P6)&P8&(~P11);
      Py3 = P1&P2&(~P3)&(~P4)&(~P5)&(~P6)&(~P7)&P8&(~P9)&(~P10)&(~P11)&(~P12)&(~P13)&(~P14)&(~P15);
      Py  = Py1|Py2|Py3;
      %--------------------------------------------------------------------%
      if ((Px==1)&&(Py~=1))
          M(h,c) = 0;
          check = 0;
      else
          M(h,c) = 1;
      end  
      end
    end
end

    %=============================================================================
    if (check ==1) 
        break;
    else
        I=I.* M;
    end
end
end

